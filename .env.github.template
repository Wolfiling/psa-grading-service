# ===============================================
# PSA GRADING APPLICATION - GITHUB ACTIONS TEMPLATE
# ===============================================
# üìã TEMPLATE DE CONFIGURATION POUR GITHUB ACTIONS CI/CD
# üîê SECRETS √Ä CONFIGURER DANS GITHUB REPOSITORY SETTINGS
# üö® NE JAMAIS COMMITER CE FICHIER AVEC LES VRAIES VALEURS !
# üéØ OPTIMIS√â POUR D√âPLOIEMENT AUTOMATIS√â GITHUB ‚Üí VPS

# ===============================================
# üåç 1. CONFIGURATION ENVIRONNEMENT
# ===============================================

# Environment (adapt√© selon la branche)
# main ‚Üí production, develop ‚Üí staging, autres ‚Üí review
NODE_ENV=production

# Port application (Docker et VPS)
PORT=5000

# Configuration proxy (OBLIGATOIRE pour VPS derri√®re load balancer)
TRUST_PROXY=true

# ===============================================
# üîó 2. DOMAINES ET URLS (GITHUB SECRETS)
# ===============================================

# Domaine principal production (√Ä CONFIGURER DANS GITHUB SECRETS)
# GitHub Secret: DOMAIN
# Valeur exemple: psa-grading.com
DOMAIN=YOUR_PRODUCTION_DOMAIN

# Domaines autoris√©s CORS (g√©n√©r√© automatiquement)
# Automatiquement configur√© selon DOMAIN:
# - https://${DOMAIN}
# - https://www.${DOMAIN} 
# - https://staging.${DOMAIN} (pour staging)
ALLOWED_ORIGINS=https://${DOMAIN},https://www.${DOMAIN}

# URL publique (g√©n√©r√©e automatiquement)
PUBLIC_URL=https://${DOMAIN}

# ===============================================
# üè† 3. SERVEURS DE D√âPLOIEMENT (GITHUB SECRETS)
# ===============================================

# SERVEUR STAGING
# GitHub Secrets requis:
STAGING_HOST=YOUR_STAGING_SERVER_IP_OR_DOMAIN
STAGING_USER=psa-app
STAGING_PORT=22
# STAGING_SSH_KEY (cl√© priv√©e SSH - secret sensible)

# SERVEUR PRODUCTION  
# GitHub Secrets requis:
PRODUCTION_HOST=YOUR_PRODUCTION_SERVER_IP_OR_DOMAIN
PRODUCTION_USER=psa-app
PRODUCTION_PORT=22
# PRODUCTION_SSH_KEY (cl√© priv√©e SSH - secret sensible)

# APPROBATEURS PRODUCTION (utilisateurs GitHub)
# Format: username1,username2,username3
PRODUCTION_APPROVERS=admin1,admin2

# ===============================================
# üîê 4. SECRETS CRITIQUES (GITHUB SECRETS)
# ===============================================

# MOTS DE PASSE ADMINISTRATEUR
# GitHub Secrets:
STAGING_ADMIN_PASSWORD=GENERATE_SECURE_PASSWORD_STAGING
PRODUCTION_ADMIN_PASSWORD=GENERATE_SECURE_PASSWORD_PRODUCTION

# SECRETS CRYPTOGRAPHIQUES (PARTAG√âS STAGING/PROD)
# G√©n√©rer avec: openssl rand -base64 64
# GitHub Secrets:
SESSION_SECRET=GENERATE_RANDOM_SESSION_SECRET
PSA_SECRET=GENERATE_RANDOM_PSA_SECRET
JWT_SECRET=GENERATE_RANDOM_JWT_SECRET
PSA_CLIENT_SECRET=GENERATE_RANDOM_CLIENT_SECRET

# ===============================================
# üóÑÔ∏è 5. BASES DE DONN√âES (GITHUB SECRETS)
# ===============================================

# BASE DE DONN√âES STAGING
# GitHub Secret: STAGING_DATABASE_URL
# Format: postgresql://user:pass@host:port/db?sslmode=require
STAGING_DATABASE_URL=postgresql://staging_user:staging_pass@staging-db.host.com:5432/psa_grading_staging?sslmode=require

# BASE DE DONN√âES PRODUCTION
# GitHub Secret: PRODUCTION_DATABASE_URL  
# Format: postgresql://user:pass@host:port/db?sslmode=require
PRODUCTION_DATABASE_URL=postgresql://prod_user:prod_pass@prod-db.host.com:5432/psa_grading_prod?sslmode=require

# Configuration SSL (activ√©e automatiquement en production)
DB_SSL=true
DB_SSL_REJECT_UNAUTHORIZED=true

# Pool de connexions (optimis√© par environnement)
DB_POOL_MIN=5
DB_POOL_MAX=20

# ===============================================
# üìß 6. SERVICES EXTERNES (GITHUB SECRETS)
# ===============================================

# SERVICE EMAIL BREVO
# GitHub Secret: BREVO_API_KEY
# Obtenez votre cl√©: https://app.brevo.com/settings/keys/api
BREVO_API_KEY=YOUR_BREVO_API_KEY_HERE

# AUTHENTIFICATION PSA
# GitHub Secrets: PSA_EMAIL, PSA_PASSWORD
# Compte professionnel PSA pour scraping automatis√©
PSA_EMAIL=your-professional-psa@email.com
PSA_PASSWORD=YOUR_PSA_PASSWORD_HERE

# TASKMASTER API (si utilis√©e)
TASKMASTER_API_URL=https://your-taskmaster.com/api/external
TASKMASTER_API_KEY=YOUR_TASKMASTER_API_KEY

# ===============================================
# üõçÔ∏è 7. INT√âGRATION SHOPIFY (OPTIONNELLE)
# ===============================================

# GitHub Secrets Shopify (si int√©gration activ√©e):
SHOPIFY_SHOP_DOMAIN=your-shop.myshopify.com
SHOPIFY_ADMIN_ACCESS_TOKEN=shpat_YOUR_ADMIN_TOKEN
SHOPIFY_STOREFRONT_ACCESS_TOKEN=YOUR_STOREFRONT_TOKEN

# ===============================================
# üìä 8. MONITORING ET NOTIFICATIONS (GITHUB SECRETS)
# ===============================================

# SLACK NOTIFICATIONS
# GitHub Secret: SLACK_WEBHOOK
# Cr√©er webhook: https://api.slack.com/messaging/webhooks
SLACK_WEBHOOK=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# GRAFANA (pour monitoring avanc√©)
# GitHub Secret: GRAFANA_ADMIN_PASSWORD
GRAFANA_ADMIN_PASSWORD=GENERATE_GRAFANA_PASSWORD
GRAFANA_SECRET_KEY=GENERATE_GRAFANA_SECRET_KEY

# ===============================================
# ‚òÅÔ∏è 9. BACKUP ET STOCKAGE (OPTIONNEL)
# ===============================================

# AWS S3 pour backups automatis√©s
# GitHub Secrets (optionnels):
BACKUP_S3_BUCKET=psa-grading-backups
AWS_ACCESS_KEY_ID=YOUR_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=YOUR_AWS_SECRET_KEY

# ===============================================
# ‚öôÔ∏è 10. CONFIGURATION AVANC√âE
# ===============================================

# Performance (adapt√©e par environnement)
MAX_UPLOAD_SIZE=10
RATE_LIMIT_MAX=1000
REQUEST_TIMEOUT=30000
ENABLE_COMPRESSION=true

# S√©curit√© (forc√©e en production)
SECURITY_HEADERS=true
ENABLE_METRICS=true

# Logging (adapt√© par environnement)
LOG_LEVEL=info
LOG_RETENTION_DAYS=30

# ===============================================
# üìù INSTRUCTIONS GITHUB ACTIONS SETUP
# ===============================================

# 1. CONFIGURER LES SECRETS GITHUB:
#    Repository ‚Üí Settings ‚Üí Secrets and Variables ‚Üí Actions
#
# 2. AJOUTER CES SECRETS OBLIGATOIRES:
#    - DOMAIN (domaine production)
#    - STAGING_HOST, STAGING_USER, STAGING_SSH_KEY
#    - PRODUCTION_HOST, PRODUCTION_USER, PRODUCTION_SSH_KEY
#    - STAGING_ADMIN_PASSWORD, PRODUCTION_ADMIN_PASSWORD
#    - SESSION_SECRET, PSA_SECRET, JWT_SECRET, PSA_CLIENT_SECRET
#    - STAGING_DATABASE_URL, PRODUCTION_DATABASE_URL
#    - BREVO_API_KEY, PSA_EMAIL, PSA_PASSWORD
#
# 3. SECRETS OPTIONNELS POUR FONCTIONNALIT√âS AVANC√âES:
#    - SLACK_WEBHOOK (notifications d√©ploiement)
#    - PRODUCTION_APPROVERS (validation manuelle prod)
#    - AWS_* (backup automatis√©)
#    - SHOPIFY_* (int√©gration e-commerce)
#
# 4. G√âN√âRATION DES SECRETS:
#    # Secrets cryptographiques
#    openssl rand -base64 64  # Pour SESSION_SECRET, PSA_SECRET, etc.
#    
#    # Mot de passe s√©curis√©
#    openssl rand -base64 32  # Pour mots de passe admin
#
# 5. CL√âS SSH POUR D√âPLOIEMENT:
#    # G√©n√©rer paire de cl√©s
#    ssh-keygen -t ed25519 -C "github-actions-psa-grading"
#    
#    # Ajouter cl√© publique sur vos serveurs VPS
#    ssh-copy-id -i ~/.ssh/id_ed25519.pub psa-app@your-server.com
#    
#    # Ajouter cl√© priv√©e comme secret GitHub
#    # Nom: STAGING_SSH_KEY ou PRODUCTION_SSH_KEY
#    # Valeur: Contenu du fichier ~/.ssh/id_ed25519 (cl√© priv√©e compl√®te)

# ===============================================
# üîç VALIDATION CONFIGURATION
# ===============================================

# V√©rifiez que tous les secrets sont configur√©s:
# GitHub Repository ‚Üí Settings ‚Üí Secrets and Variables ‚Üí Actions
# Vous devez voir au minimum 10-15 secrets configur√©s

# Test du d√©ploiement:
# 1. Push sur develop ‚Üí d√©clenchement staging
# 2. Push sur main ‚Üí d√©clenchement production (avec approbation manuelle)

# ===============================================
# üö® S√âCURIT√â - POINTS CRITIQUES
# ===============================================
# ‚ö†Ô∏è JAMAIS de vraies valeurs dans ce fichier template
# ‚ö†Ô∏è Cl√©s SSH priv√©es uniquement dans GitHub Secrets
# ‚ö†Ô∏è Mots de passe diff√©rents staging/production  
# ‚ö†Ô∏è Rotation r√©guli√®re des secrets (tous les 90 jours)
# ‚ö†Ô∏è Audit r√©gulier des acc√®s GitHub Secrets
# ‚ö†Ô∏è Backup des secrets dans coffre-fort s√©curis√©
# ‚ö†Ô∏è Notifications Slack pour surveillance d√©ploiements